@using IranSoftjo.Core.Web.Mvc.Html
@model IranSoftjo.Package.WebUi.ViewModels.SendSmsVm
@{
    ViewBag.Title = "ارسال پیامک";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>
    /*.pageContentRightDiv {
        padding: 20px 20px 0 0;
    }*/
    .form td {
        padding: 7px 27px 7px 0;
    }

    textarea {
        height: 100px !important;
        width: 100% !important;
    }
</style>
@using (Html.BeginForm())
{
    <table class="form">
        <tr>
            <td class="labelWrp">
                <label>
                    <strong style="float: right; font-size: 12px;margin-top: 2px;">کد مسافر :</strong>
                </label>
            </td>
            <td>
                <input class="k-textbox" type="text" value="0" id="txt_PassengerID" name="txt_PassengerID" style="float: right; font-size: 14px; width: 70px;">
                <div id="PassengerShow" style="margin: 0 10px 0 1px;  color: #F46819; float: right; font-size: 12px">
                    لطفا کد مسافر را وارد نمایید
                </div>
            </td>
        </tr>

        <tr>
            <td class="labelWrp">
                <label>
                    <strong style="float: right; font-size: 12px;margin-top: 2px;">کد مسیر :</strong>
                </label>

            </td>
            <td>
                <input class="k-textbox" type="text" value="0" id="txt_TrackID" name="txt_TrackID" style="float: right; font-size: 14px; width: 70px;">

                <div id="TrackShow" style="margin: 0 10px 0 1px; color: #F46819; float: right; font-size: 12px">
                    لطفا کد مسیر را وارد نمایید
                </div>

            </td>
        </tr>
        <tr>
            <td class="labelWrp">
                <label>
                    <strong style="float: right; font-size: 12px;margin-top: 2px;">کد راننده :</strong>
                </label>

            </td>
            <td>
                <input class="k-textbox" value="0" type="text" id="txt_DriverID" name="txt_DriverID" style="float: right; font-size: 14px; width: 70px;">

                <div id="DriverShow" style="margin: 0 10px 0 1px; ;color: #F46819; float: right; font-size: 12px">
                    لطفا کد راننده را وارد نمایید
                </div>


            </td>
        </tr>
        <tr>
            <td class="labelWrp">
                <label>
                    <strong style="float: right; font-size: 12px;margin-top: 2px;">شماره موبایل راننده :</strong>
                </label>


            </td>
            <td>
                <input id="Mobile" class="k-textbox" type="text" value="" style="width: 40em" name="Mobile">
            </td>
        </tr>
        <tr>
            <td class="labelWrp">
                <label>
                    <strong style="float: right; font-size: 12px;margin-top: 2px;">متن پیامک :</strong>
                </label>
            </td>
            <td>
                @*<div id="charCount">
                        تعداد کاراکتر ها :
                    </div>*@
                <textarea class="k-textbox" id="SmsText" name="SmsText" rows="2"></textarea>
            </td>
        </tr>


        <tr>
            <td class="labelWrp">
                <br />
                <span>
                    @Html.ActionLink("خالی کردن و دوباره", "Index", "SendSms", new { @class = "k-button k-button-icontext" })
                </span>
            </td>
            <td>
                <input class="k-button k-button-icontext" type="submit" value="ارسال پیامک">
            </td>
        </tr>
    </table>
}
<script src="~/Scripts/jquery-1.8.2.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        //$('#SmsText').keyup(function () {
        //    $('#charCount').text(this.value.replace(/{.*}/g, '').length + ' تعداد کاراکتر ها : ');
        //});
        $('#txt_PassengerID').keyup(function () {
            var txtValue = $('#txt_PassengerID').val();
            $.ajax({
                url: "/api/SendSmsApi",
                data: { passengerId: txtValue, driverId: '', trackId: '' },
                type: "GET"
            }).done(function (result) {
                if (result)
                    $("#PassengerShow").fadeOut(200).html(result).fadeIn(250);
                if (result != 'مسافری با این مشخصات یافت نشد')
                    $("#SmsText").fadeOut(200).append(result).fadeIn(250);
            });
        });
        $('#txt_DriverID').keyup(function () {
            var txtValue = $('#txt_DriverID').val();
            $.ajax({
                url: "/api/SendSmsApi",
                data: { passengerId: '', driverId: txtValue, trackId: '' },
                type: "GET"
            }).done(function (result) {
                if (result) {
                    $("#DriverShow").fadeOut(200).html(result).fadeIn(250);
                    if (result != 'راننده با این مشخصات یافت نشد')
                        $("#SmsText").fadeOut(200).append(result).fadeIn(250);
                }
            });
        });
        $('#txt_TrackID').keyup(function () {
            var txtValue = $('#txt_TrackID').val();
            $.ajax({
                url: "/api/SendSmsApi",
                data: { passengerId: '', driverId: '', trackId: txtValue },
                type: "GET"
            }).done(function (result) {
                if (result) {
                    $("#TrackShow").fadeOut(200).html(result).fadeIn(250);
                    if (result != 'مسیر با این مشخصات یافت نشد')
                        $("#SmsText").fadeOut(200).append(result).fadeIn(250);

                }
            });
        });

        $('#txt_DriverID').keyup(function () {
            var txtValue = $('#txt_DriverID').val();
            $.ajax({
                url: "/api/SendSmsApi",
                data: { driverId: txtValue },
                type: "GET"
            }).done(function (result) {
                if (result) {
                    $("#Mobile").fadeOut(200).val(result).fadeIn(250);
                }
            });
        });
    });

</script>

